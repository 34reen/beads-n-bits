{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 7, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/dell/beads-n-bits/frontend/src/components/ProductCard.tsx"],"sourcesContent":["\"use client\";\r\n\r\nimport Image from \"next/image\";\r\nimport { useState, useEffect } from \"react\";\r\nimport { Product } from \"@/types\"; // Shared type\r\n\r\nexport default function ProductCard({ product }: { product: Product }) {\r\n  const [isWishlisted, setIsWishlisted] = useState(false);\r\n  const [imageError, setImageError] = useState(false);\r\n\r\n  const backendUrl = process.env.NEXT_PUBLIC_BACKEND_URL || \"http://localhost/backend\";\r\n\r\n// Clean the image path to ensure it's just a filename\r\nconst getCleanImageUrl = (imagePath: string) => {\r\n  // If it's already a messed up URL, extract just the filename\r\n  if (imagePath.includes('http://localhost/backend/')) {\r\n    // Extract the last part after the last slash\r\n    const parts = imagePath.split('/');\r\n    const filename = parts[parts.length - 1];\r\n    return `${backendUrl}/admin/uploads/${filename}`;\r\n  }\r\n  // If it's just a filename, use it directly\r\n  return `${backendUrl}/admin/uploads/${imagePath}`;\r\n};\r\n\r\nconst imageUrl = product.image ? getCleanImageUrl(product.image) : \"/placeholder.png\";\r\n\r\n /*\r\n===========================================================\r\n                 üî• WISHLIST SECTION (UPDATED)\r\n===========================================================\r\n*/\r\n\r\n// Load wishlist state\r\nuseEffect(() => {\r\n  const wishlist: string[] = JSON.parse(localStorage.getItem(\"wishlist\") || \"[]\");\r\n  setIsWishlisted(wishlist.includes(product.id)); // No need for toString() now\r\n}, [product.id]);\r\n\r\n// Toggle wishlist + backend sync\r\nconst toggleWishlist = async () => {\r\n  const wishlist: string[] = JSON.parse(localStorage.getItem(\"wishlist\") || \"[]\");\r\n\r\n  let updatedWishlist: string[];\r\n\r\n  if (isWishlisted) {\r\n    // Remove from wishlist\r\n    updatedWishlist = wishlist.filter((id) => id !== product.id); // Direct comparison\r\n\r\n    try {\r\n      await fetch(`${backendUrl}/store-api/wishlist/remove-from-wishlist.php`, {\r\n        method: \"POST\",\r\n        headers: { \"Content-Type\": \"application/json\" },\r\n        body: JSON.stringify({\r\n          userId: 1,\r\n          productId: product.id, // Should work with string IDs\r\n        }),\r\n      });\r\n    } catch (error) {\r\n      console.error(\"Failed to sync remove:\", error);\r\n    }\r\n  } else {\r\n    // Add to wishlist\r\n    updatedWishlist = [...wishlist, product.id]; // Direct assignment\r\n\r\n    try {\r\n      await fetch(`${backendUrl}/store-api/wishlist/add-to-wishlist.php`, {\r\n        method: \"POST\",\r\n        headers: { \"Content-Type\": \"application/json\" },\r\n        body: JSON.stringify({\r\n          userId: 1,\r\n          productId: product.id, // Should work with string IDs\r\n        }),\r\n      });\r\n    } catch (error) {\r\n      console.error(\"Failed to sync add:\", error);\r\n    }\r\n  }\r\n\r\n  // Save to localStorage\r\n  localStorage.setItem(\"wishlist\", JSON.stringify(updatedWishlist));\r\n\r\n  // Update UI\r\n  setIsWishlisted(!isWishlisted);\r\n};\r\n\r\n/*\r\n===========================================================\r\n                       END WISHLIST SECTION\r\n===========================================================\r\n*/\r\n\r\n  type CartItem = Product & { quantity: number };\r\n\r\n // Add to cart logic\r\nconst handleAddToCart = async () => {\r\n  await fetch(`${backendUrl}/store-api/cart/add-to-cart.php`, {\r\n    method: \"POST\",\r\n    headers: { \"Content-Type\": \"application/json\" },\r\n    body: JSON.stringify({\r\n      userId: 1,\r\n      productId: product.id,\r\n      quantity: 1,\r\n    }),\r\n  });\r\n\r\n  const existingCart: CartItem[] = JSON.parse(localStorage.getItem(\"cart\") || \"[]\");\r\n  const itemIndex = existingCart.findIndex((item) => item.id === product.id);\r\n\r\n  // Clean up the image URL to ensure it's just the filename\r\n  const cleanImageUrl = (imagePath: string) => {\r\n    // If it contains the double URL, extract just the filename\r\n    if (imagePath.includes('http://localhost/backend/http://localhost/backend/')) {\r\n      return imagePath.replace('http://localhost/backend/http://localhost/backend/uploads/', '');\r\n    }\r\n    // If it's a full URL, extract just the filename\r\n    if (imagePath.includes('http://localhost/backend/uploads/')) {\r\n      return imagePath.replace('http://localhost/backend/uploads/', '');\r\n    }\r\n    // If it's a full URL with admin path, extract just the filename\r\n    if (imagePath.includes('http://localhost/backend/admin/uploads/')) {\r\n      return imagePath.replace('http://localhost/backend/admin/uploads/', '');\r\n    }\r\n    // Otherwise return as is (should be just filename)\r\n    return imagePath;\r\n  };\r\n\r\n  const cleanProduct = {\r\n    ...product,\r\n    image: cleanImageUrl(product.image)\r\n  };\r\n\r\n  let updatedCart;\r\n  if (itemIndex > -1) {\r\n    existingCart[itemIndex].quantity += 1;\r\n    updatedCart = existingCart;\r\n  } else {\r\n    updatedCart = [...existingCart, { ...cleanProduct, quantity: 1 }];\r\n  }\r\n\r\n  localStorage.setItem(\"cart\", JSON.stringify(updatedCart));\r\n  alert(`${product.name} added to cart!`);\r\n};\r\nreturn (\r\n  <div className=\"bg-white shadow-md rounded-lg overflow-hidden hover:shadow-xl transition-shadow duration-300 relative\">\r\n\r\n    <Image\r\n      src={imageError ? \"/placeholder.png\" : imageUrl}\r\n      alt={product.name}\r\n      width={400}\r\n      height={300}\r\n      className=\"w-full object-cover h-60\"\r\n      onError={() => setImageError(true)}\r\n      priority={true}\r\n    />\r\n\r\n    {/* Wishlist Button */}\r\n    <button\r\n      onClick={toggleWishlist}\r\n      className=\"absolute top-3 right-3 bg-white p-2 rounded-full shadow hover:scale-105 transition\"\r\n      aria-label=\"Add to wishlist\"\r\n    >\r\n      <span className={isWishlisted ? \"text-red-500\" : \"text-gray-400\"}>\r\n        {isWishlisted ? \"‚ù§Ô∏è\" : \"ü§ç\"}\r\n      </span>\r\n    </button>\r\n\r\n    <div className=\"p-4\">\r\n      <h2 className=\"text-lg font-semibold text-gray-800\">{product.name}</h2>\r\n      <p className=\"text-purple-700 font-bold mt-2\">\r\n  Ksh {Math.round(product.price).toLocaleString()}\r\n      </p>\r\n     <p className=\"text-sm text-gray-500 mt-1\">\r\n  ‚≠ê {(Number(product.rating) || 0).toFixed(1)} / 5\r\n</p>\r\n\r\n      {/* Add to Cart Button */}\r\n      <button\r\n        onClick={handleAddToCart}\r\n        className=\"mt-4 w-full bg-purple-600 text-white py-2 rounded hover:bg-purple-700 transition\"\r\n      >\r\n        Add to Cart\r\n      </button>\r\n    </div>\r\n  </div>\r\n  );}"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 239, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/dell/beads-n-bits/frontend/src/app/wishlist/page.tsx"],"sourcesContent":["\"use client\";\r\nimport { useEffect, useState } from \"react\";\r\nimport ProductCard from \"@/components/ProductCard\";\r\nimport { TbShoppingCartHeart } from \"react-icons/tb\";\r\n\r\ntype Product = {\r\n  id: string;\r\n  name: string;\r\n  price: number;\r\n  image: string;\r\n  rating: number;\r\n};\r\n\r\nexport default function WishlistPage() {\r\n  const [wishlist, setWishlist] = useState<string[]>([]);\r\n  const [products, setProducts] = useState<Product[]>([]);\r\n  const [loading, setLoading] = useState(true);\r\n  const backendUrl = process.env.NEXT_PUBLIC_BACKEND_URL || \"http://localhost/backend\";\r\n\r\n  useEffect(() => {\r\n    // Load wishlist\r\n    const stored = localStorage.getItem(\"wishlist\");\r\n    if (stored) {\r\n      setWishlist(JSON.parse(stored));\r\n    }\r\n\r\n    // Fetch real products from backend\r\n    const fetchProducts = async () => {\r\n      try {\r\n        const response = await fetch(`${backendUrl}/store-api/products/get-products.php`);\r\n        const data = await response.json();\r\n        setProducts(data);\r\n      } catch (error) {\r\n        console.error(\"Failed to fetch products:\", error);\r\n      } finally {\r\n        setLoading(false);\r\n      }\r\n    };\r\n\r\n    fetchProducts();\r\n  }, [backendUrl]);\r\n\r\n  const filteredProducts = products.filter((product) =>\r\n    wishlist.includes(product.id)\r\n  );\r\n\r\n  if (loading) {\r\n    return (\r\n      <div className=\"text-center py-12\">\r\n        <div className=\"text-lg text-gray-600\">Loading...</div>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  if (filteredProducts.length === 0) {\r\n    return (\r\n      <div className=\"text-center py-12\">\r\n        <TbShoppingCartHeart className=\"mx-auto mb-4 text-6xl text-gray-400\" />\r\n        <h2 className=\"text-xl font-semibold text-gray-600\">\r\n          Your wishlist is empty.\r\n        </h2>\r\n        <p className=\"text-gray-500 mt-2\">\r\n          Looks like you have not added anything yet.\r\n        </p>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <main className=\"max-w-7xl mx-auto p-4\">\r\n      <h1 className=\"text-3xl font-bold text-purple-700 mb-6\">Your Wishlist</h1>\r\n      <div className=\"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6\">\r\n        {filteredProducts.map((product) => (\r\n          <ProductCard key={product.id} product={product} />\r\n        ))}\r\n      </div>\r\n    </main>\r\n  );\r\n}"],"names":[],"mappings":";;;;AACA;AACA;AACA;AAHA;;;;;AAae,SAAS;IACtB,MAAM,CAAC,UAAU,YAAY,GAAG,CAAA,GAAA,qMAAA,CAAA,WAAQ,AAAD,EAAY,EAAE;IACrD,MAAM,CAAC,UAAU,YAAY,GAAG,CAAA,GAAA,qMAAA,CAAA,WAAQ,AAAD,EAAa,EAAE;IACtD,MAAM,CAAC,SAAS,WAAW,GAAG,CAAA,GAAA,qMAAA,CAAA,WAAQ,AAAD,EAAE;IACvC,MAAM,aAAa,QAAQ,GAAG,CAAC,uBAAuB,IAAI;IAE1D,CAAA,GAAA,qMAAA,CAAA,YAAS,AAAD,EAAE;QACR,gBAAgB;QAChB,MAAM,SAAS,aAAa,OAAO,CAAC;QACpC,IAAI,QAAQ;YACV,YAAY,KAAK,KAAK,CAAC;QACzB;QAEA,mCAAmC;QACnC,MAAM,gBAAgB;YACpB,IAAI;gBACF,MAAM,WAAW,MAAM,MAAM,GAAG,WAAW,oCAAoC,CAAC;gBAChF,MAAM,OAAO,MAAM,SAAS,IAAI;gBAChC,YAAY;YACd,EAAE,OAAO,OAAO;gBACd,QAAQ,KAAK,CAAC,6BAA6B;YAC7C,SAAU;gBACR,WAAW;YACb;QACF;QAEA;IACF,GAAG;QAAC;KAAW;IAEf,MAAM,mBAAmB,SAAS,MAAM,CAAC,CAAC,UACxC,SAAS,QAAQ,CAAC,QAAQ,EAAE;IAG9B,IAAI,SAAS;QACX,qBACE,8OAAC;YAAI,WAAU;sBACb,cAAA,8OAAC;gBAAI,WAAU;0BAAwB;;;;;;;;;;;IAG7C;IAEA,IAAI,iBAAiB,MAAM,KAAK,GAAG;QACjC,qBACE,8OAAC;YAAI,WAAU;;8BACb,8OAAC,8IAAA,CAAA,sBAAmB;oBAAC,WAAU;;;;;;8BAC/B,8OAAC;oBAAG,WAAU;8BAAsC;;;;;;8BAGpD,8OAAC;oBAAE,WAAU;8BAAqB;;;;;;;;;;;;IAKxC;IAEA,qBACE,8OAAC;QAAK,WAAU;;0BACd,8OAAC;gBAAG,WAAU;0BAA0C;;;;;;0BACxD,8OAAC;gBAAI,WAAU;0BACZ,iBAAiB,GAAG,CAAC,CAAC,wBACrB,8OAAC,iIAAA,CAAA,UAAW;wBAAkB,SAAS;uBAArB,QAAQ,EAAE;;;;;;;;;;;;;;;;AAKtC","debugId":null}}]
}