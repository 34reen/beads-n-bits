{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 7, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/dell/beads-n-bits/frontend/src/components/ProductCard.tsx"],"sourcesContent":["\"use client\";\r\n\r\nimport Image from \"next/image\";\r\nimport { useState, useEffect } from \"react\";\r\nimport { Product } from \"@/types\"; // Shared type\r\n\r\nexport default function ProductCard({ product }: { product: Product }) {\r\n  const [isWishlisted, setIsWishlisted] = useState(false);\r\n  const [imageError, setImageError] = useState(false);\r\n\r\n  const backendUrl = process.env.NEXT_PUBLIC_BACKEND_URL || \"http://localhost/backend\";\r\n\r\n// Clean the image path to ensure it's just a filename\r\nconst getCleanImageUrl = (imagePath: string) => {\r\n  // If it's already a messed up URL, extract just the filename\r\n  if (imagePath.includes('http://localhost/backend/')) {\r\n    // Extract the last part after the last slash\r\n    const parts = imagePath.split('/');\r\n    const filename = parts[parts.length - 1];\r\n    return `${backendUrl}/admin/uploads/${filename}`;\r\n  }\r\n  // If it's just a filename, use it directly\r\n  return `${backendUrl}/admin/uploads/${imagePath}`;\r\n};\r\n\r\nconst imageUrl = product.image ? getCleanImageUrl(product.image) : \"/placeholder.png\";\r\n\r\n /*\r\n===========================================================\r\n                 üî• WISHLIST SECTION (UPDATED)\r\n===========================================================\r\n*/\r\n\r\n// Load wishlist state\r\nuseEffect(() => {\r\n  const wishlist: string[] = JSON.parse(localStorage.getItem(\"wishlist\") || \"[]\");\r\n  setIsWishlisted(wishlist.includes(product.id)); // No need for toString() now\r\n}, [product.id]);\r\n\r\n// Toggle wishlist + backend sync\r\nconst toggleWishlist = async () => {\r\n  const wishlist: string[] = JSON.parse(localStorage.getItem(\"wishlist\") || \"[]\");\r\n\r\n  let updatedWishlist: string[];\r\n\r\n  if (isWishlisted) {\r\n    // Remove from wishlist\r\n    updatedWishlist = wishlist.filter((id) => id !== product.id); // Direct comparison\r\n\r\n    try {\r\n      await fetch(`${backendUrl}/store-api/wishlist/remove-from-wishlist.php`, {\r\n        method: \"POST\",\r\n        headers: { \"Content-Type\": \"application/json\" },\r\n        body: JSON.stringify({\r\n          userId: 1,\r\n          productId: product.id, // Should work with string IDs\r\n        }),\r\n      });\r\n    } catch (error) {\r\n      console.error(\"Failed to sync remove:\", error);\r\n    }\r\n  } else {\r\n    // Add to wishlist\r\n    updatedWishlist = [...wishlist, product.id]; // Direct assignment\r\n\r\n    try {\r\n      await fetch(`${backendUrl}/store-api/wishlist/add-to-wishlist.php`, {\r\n        method: \"POST\",\r\n        headers: { \"Content-Type\": \"application/json\" },\r\n        body: JSON.stringify({\r\n          userId: 1,\r\n          productId: product.id, // Should work with string IDs\r\n        }),\r\n      });\r\n    } catch (error) {\r\n      console.error(\"Failed to sync add:\", error);\r\n    }\r\n  }\r\n\r\n  // Save to localStorage\r\n  localStorage.setItem(\"wishlist\", JSON.stringify(updatedWishlist));\r\n\r\n  // Update UI\r\n  setIsWishlisted(!isWishlisted);\r\n};\r\n\r\n/*\r\n===========================================================\r\n                       END WISHLIST SECTION\r\n===========================================================\r\n*/\r\n\r\n  type CartItem = Product & { quantity: number };\r\n\r\n // Add to cart logic\r\nconst handleAddToCart = async () => {\r\n  await fetch(`${backendUrl}/store-api/cart/add-to-cart.php`, {\r\n    method: \"POST\",\r\n    headers: { \"Content-Type\": \"application/json\" },\r\n    body: JSON.stringify({\r\n      userId: 1,\r\n      productId: product.id,\r\n      quantity: 1,\r\n    }),\r\n  });\r\n\r\n  const existingCart: CartItem[] = JSON.parse(localStorage.getItem(\"cart\") || \"[]\");\r\n  const itemIndex = existingCart.findIndex((item) => item.id === product.id);\r\n\r\n  // Clean up the image URL to ensure it's just the filename\r\n  const cleanImageUrl = (imagePath: string) => {\r\n    // If it contains the double URL, extract just the filename\r\n    if (imagePath.includes('http://localhost/backend/http://localhost/backend/')) {\r\n      return imagePath.replace('http://localhost/backend/http://localhost/backend/uploads/', '');\r\n    }\r\n    // If it's a full URL, extract just the filename\r\n    if (imagePath.includes('http://localhost/backend/uploads/')) {\r\n      return imagePath.replace('http://localhost/backend/uploads/', '');\r\n    }\r\n    // If it's a full URL with admin path, extract just the filename\r\n    if (imagePath.includes('http://localhost/backend/admin/uploads/')) {\r\n      return imagePath.replace('http://localhost/backend/admin/uploads/', '');\r\n    }\r\n    // Otherwise return as is (should be just filename)\r\n    return imagePath;\r\n  };\r\n\r\n  const cleanProduct = {\r\n    ...product,\r\n    image: cleanImageUrl(product.image)\r\n  };\r\n\r\n  let updatedCart;\r\n  if (itemIndex > -1) {\r\n    existingCart[itemIndex].quantity += 1;\r\n    updatedCart = existingCart;\r\n  } else {\r\n    updatedCart = [...existingCart, { ...cleanProduct, quantity: 1 }];\r\n  }\r\n\r\n  localStorage.setItem(\"cart\", JSON.stringify(updatedCart));\r\n  alert(`${product.name} added to cart!`);\r\n};\r\nreturn (\r\n  <div className=\"bg-white shadow-md rounded-lg overflow-hidden hover:shadow-xl transition-shadow duration-300 relative\">\r\n\r\n    <Image\r\n      src={imageError ? \"/placeholder.png\" : imageUrl}\r\n      alt={product.name}\r\n      width={400}\r\n      height={300}\r\n      className=\"w-full object-cover h-60\"\r\n      onError={() => setImageError(true)}\r\n      priority={true}\r\n    />\r\n\r\n    {/* Wishlist Button */}\r\n    <button\r\n      onClick={toggleWishlist}\r\n      className=\"absolute top-3 right-3 bg-white p-2 rounded-full shadow hover:scale-105 transition\"\r\n      aria-label=\"Add to wishlist\"\r\n    >\r\n      <span className={isWishlisted ? \"text-red-500\" : \"text-gray-400\"}>\r\n        {isWishlisted ? \"‚ù§Ô∏è\" : \"ü§ç\"}\r\n      </span>\r\n    </button>\r\n\r\n    <div className=\"p-4\">\r\n      <h2 className=\"text-lg font-semibold text-gray-800\">{product.name}</h2>\r\n      <p className=\"text-purple-700 font-bold mt-2\">\r\n  Ksh {Math.round(product.price).toLocaleString()}\r\n      </p>\r\n     <p className=\"text-sm text-gray-500 mt-1\">\r\n  ‚≠ê {(Number(product.rating) || 0).toFixed(1)} / 5\r\n</p>\r\n\r\n      {/* Add to Cart Button */}\r\n      <button\r\n        onClick={handleAddToCart}\r\n        className=\"mt-4 w-full bg-purple-600 text-white py-2 rounded hover:bg-purple-700 transition\"\r\n      >\r\n        Add to Cart\r\n      </button>\r\n    </div>\r\n  </div>\r\n  );}"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 251, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/dell/beads-n-bits/frontend/src/app/products/page.tsx"],"sourcesContent":["\"use client\";\r\n\r\nimport { useEffect, useState } from \"react\";\r\nimport ProductCard from \"@/components/ProductCard\";\r\nimport type { Product } from \"@/types\"; // ‚úÖ Correct import\r\n\r\nexport default function ProductsPage() {\r\n  const [products, setProducts] = useState<Product[]>([]);\r\n  const [loading, setLoading] = useState(true);\r\n\r\n  useEffect(() => {\r\n    const fetchProducts = async () => {\r\n      try {\r\n        const res = await fetch(\r\n          \"http://localhost/backend/store-api/products/get-products.php\"\r\n        );\r\n\r\n        const data = await res.json();\r\n\r\n        // Ensure data is an array\r\n        if (!Array.isArray(data)) {\r\n          console.error(\"Invalid products format:\", data);\r\n          setProducts([]);\r\n          return;\r\n        }\r\n\r\n        const updatedData: Product[] = data.map((p) => ({\r\n          ...p,\r\n          price: Number(p.price) || 0,\r\n          rating: Number(p.rating) || 0,\r\n          image:\r\n            p.image && p.image.trim() !== \"\"\r\n              ? `http://localhost/backend/${p.image}`\r\n              : \"/placeholder.png\",\r\n        }));\r\n\r\n        setProducts(updatedData);\r\n      } catch (error) {\r\n        console.error(\"Failed to fetch products:\", error);\r\n      } finally {\r\n        setLoading(false);\r\n      }\r\n    };\r\n\r\n    fetchProducts();\r\n  }, []);\r\n\r\n  if (loading) return <p>Loading products...</p>;\r\n\r\n  return (\r\n    <main className=\"max-w-7xl mx-auto p-4\">\r\n      <h1 className=\"text-3xl font-bold text-purple-700 mb-6\">\r\n        Our Jewelry Collection\r\n      </h1>\r\n\r\n      {products.length === 0 ? (\r\n        <p className=\"text-gray-500 text-lg\">No products available</p>\r\n      ) : (\r\n        <div className=\"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6\">\r\n          {products.map((product) => (\r\n            <ProductCard key={product.id} product={product} />\r\n          ))}\r\n        </div>\r\n      )}\r\n    </main>\r\n  );\r\n}\r\n"],"names":[],"mappings":";;;;AAEA;AACA;;;AAHA;;;AAMe,SAAS;;IACtB,MAAM,CAAC,UAAU,YAAY,GAAG,CAAA,GAAA,6JAAA,CAAA,WAAQ,AAAD,EAAa,EAAE;IACtD,MAAM,CAAC,SAAS,WAAW,GAAG,CAAA,GAAA,6JAAA,CAAA,WAAQ,AAAD,EAAE;IAEvC,CAAA,GAAA,6JAAA,CAAA,YAAS,AAAD;kCAAE;YACR,MAAM;wDAAgB;oBACpB,IAAI;wBACF,MAAM,MAAM,MAAM,MAChB;wBAGF,MAAM,OAAO,MAAM,IAAI,IAAI;wBAE3B,0BAA0B;wBAC1B,IAAI,CAAC,MAAM,OAAO,CAAC,OAAO;4BACxB,QAAQ,KAAK,CAAC,4BAA4B;4BAC1C,YAAY,EAAE;4BACd;wBACF;wBAEA,MAAM,cAAyB,KAAK,GAAG;gFAAC,CAAC,IAAM,CAAC;oCAC9C,GAAG,CAAC;oCACJ,OAAO,OAAO,EAAE,KAAK,KAAK;oCAC1B,QAAQ,OAAO,EAAE,MAAM,KAAK;oCAC5B,OACE,EAAE,KAAK,IAAI,EAAE,KAAK,CAAC,IAAI,OAAO,KAC1B,CAAC,yBAAyB,EAAE,EAAE,KAAK,EAAE,GACrC;gCACR,CAAC;;wBAED,YAAY;oBACd,EAAE,OAAO,OAAO;wBACd,QAAQ,KAAK,CAAC,6BAA6B;oBAC7C,SAAU;wBACR,WAAW;oBACb;gBACF;;YAEA;QACF;iCAAG,EAAE;IAEL,IAAI,SAAS,qBAAO,6LAAC;kBAAE;;;;;;IAEvB,qBACE,6LAAC;QAAK,WAAU;;0BACd,6LAAC;gBAAG,WAAU;0BAA0C;;;;;;YAIvD,SAAS,MAAM,KAAK,kBACnB,6LAAC;gBAAE,WAAU;0BAAwB;;;;;qCAErC,6LAAC;gBAAI,WAAU;0BACZ,SAAS,GAAG,CAAC,CAAC,wBACb,6LAAC,oIAAA,CAAA,UAAW;wBAAkB,SAAS;uBAArB,QAAQ,EAAE;;;;;;;;;;;;;;;;AAMxC;GA5DwB;KAAA","debugId":null}}]
}